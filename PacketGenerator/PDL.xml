<?xml version="1.0" encoding="utf-8" ?>
<!-- 
  ※ 플레이어의 C_ 즉, 플레이어가 보내는 패킷들은 ID가 필요없다.(어짜피 보내는 ID가 자신뿐이라, 자동 부여됨.)
  ※ S_는 플레이어, 오브젝트, 몬스터 모두가 보낼 수 있기 때문에, ID와 타입이 필요하다.
-->

<!-- S_BroadcastPlayerEnterGame와  S_BroadcastPlayerList는 동일한 패킷 유지해야 함...
     ID부터 형식이 동일해야 함. 클라가 서버 연결 시, EnterGame을 보내기 때문에, GameRoom에 값들을 설정해 주어야 하고,
     그 설정된 값들을 이용하여, PlayerList를 보내줘야 하기 때문!!! -->

<PDL>
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <!-- 선 SR 패킷 = 처음 연결되면, 연결된 클라에게 정보를 요청 -->
    <packet name = "S_RequestNewPlayerState"> 
        <int name = "ID"/>
    </packet>

    <!-- 후 CR 패킷 = 요청한 정보를 보내줌 -->
    <packet name = "C_MyState">
        <string name = "serialNumber"/>
        <string name = "nickname"/>
        <int    name = "currentLevel"/>
        <int    name = "currentHp"/>
        
        <string name = "savedScene"/>
        <string name = "savedPos"/>
    </packet>
    
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

    <!-- 세팅이 끝나면, 자기 자신 및 모든 플레이어 Room.Enter를 통해, 정보를 받아옴  -->
    <packet name = "S_BroadcastEntityList">
       <list  name = "entity">
             <int    name = "entityType"/>
       
             <string name = "serialNumber"/>
             <string name = "nickname"/>
             <int    name = "currentLevel"/>
             <int    name = "currentHp"/>
            
             <bool  name = "isSelf"/>
             <bool  name = "live"/>
             <bool  name = "invincibility"/>
             <int   name = "ID"/>
             <float name = "posX"/>
             <float name = "posY"/>
             <float name = "posZ"/>
             <float name = "rotationY"/>
             <int   name = "animationID"/>
       </list>
    </packet>
    
    <!-- 다른 플레이어들에게 엔티티 입장 알리기-->
    <packet name = "S_BroadcastEntityEnter">
      <int   name = "ID"/>
      
      <int    name = "entityType"/>
      
      <string name = "serialNumber"/>
      <string name = "nickname"/>
      <int    name = "currentLevel"/>
      <int    name = "currentHp"/>
      
      <bool  name = "live"/>
      <bool  name = "invincibility"/>
      <float name = "posX"/>
      <float name = "posY"/>
      <float name = "posZ"/>
      <float name = "rotationY"/>
      <int   name = "animationID"/>
    </packet>
    
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

    <!-- 클라이언트 전용 
         플레이어가 C_SceneChange를 보내면서, 방을 옮기면서, 서버에서 PlayerLeaveGame도 같이 보내지고,  Enter 및 List도 함께 일어난다-->
    <packet name = "C_SceneChange">
        <string name = "fromScene"/>
        <string name = "toScene"/>
    </packet>
    
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

    <!-- 클라이언트 전용 -->
    <packet name = "C_MyLeaveGame">
    </packet>

    <!-- 엔티티 공통 전용 -->
    <packet name = "S_BroadcastEntityLeaveGame">
        <int name = "ID"/>
        <int name = "entityType"/>
    </packet>
    
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    
    <packet name = "C_EntityInfoChange">
        <int   name   = "entityType"/>
        <int   name   = "currentLevel"/>
        <int   name   = "currentHp"/>
        <bool  name   = "invincibility"/>
    </packet>

    <packet name = "S_BroadcastEntityInfoChange">
        <int  name   = "ID"/>
        <int  name   = "entityType"/>
        <int  name   = "currentLevel"/>
        <int  name   = "currentHp"/>
        <bool name   = "invincibility"/>
    </packet>

<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    
    <packet name = "C_EntityMove">
      <int   name = "entityType"/>
      <float name = "posX"/>
      <float name = "posY"/>
      <float name = "posZ"/>
    </packet>
    
    <packet name = "S_BroadcastEntityMove">
      <int   name = "ID"/>
      <int   name = "entityType"/>
      <float name = "posX"/>
      <float name = "posY"/>
      <float name = "posZ"/>
    </packet>
    
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
      
    <packet name = "C_EntityRotation">
        <int   name = "entityType"/>
        <float name = "rotationY"/>
    </packet>

    <packet name = "S_BroadcastEntityRotation">
        <int   name = "ID"/>
        <int   name = "entityType"/>
        <float name = "rotationY"/>
    </packet>
    
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    
    <packet name = "C_EntityAnimation">
      <int name = "entityType"/>
      <int name = "animationID"/>
    </packet>
      
    <packet name = "S_BroadcastEntityAnimation">
      <int name = "ID"/>
      <int name = "entityType"/>
      <int name = "animationID"/>
    </packet>
    
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    
    <packet name = "C_EntityAttackAnimation">
        <int   name = "entityType"/>
        <int   name = "animationID"/>
        <int   name = "attackAnimeNumID"/>
        <float name = "posX"/>
        <float name = "posY"/>
        <float name = "posZ"/>
    </packet>
    
    <packet name = "S_BroadcastEntityAttackAnimation">
        <int   name = "ID"/>
        <int   name = "entityType"/>
        <int   name = "animationID"/>
        <int   name = "attackAnimeNumID"/>
        <float name = "posX"/>
        <float name = "posY"/>
        <float name = "posZ"/>
    </packet>

<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

    <!-- 1개의 단일 공격에 대해서, 체크 -->
    <packet name = "C_EntityAttackCheck">
        <int   name = "entityType"/>
        <float name = "posX"/>
        <float name = "posY"/>
        <float name = "posZ"/>
        <float name = "rotationY"/>
        <float name = "ab_sizeX"/>
        <float name = "ab_sizeY"/>
        <float name = "ab_sizeZ"/>
        <int   name = "damage"/>
    </packet>

    <!-- 1개의 단일 공격에 대해서, 체크한 리스트 결과를 브로드캐스트-->
    <packet name = "S_BroadcastEntityAttackResult">
        <!-- 공격을 가한 엔티티의 정보 -->
        <int name = "attackerID"/> 
        <int name = "attackerEntityType"/>

        <!-- 공격을 받은 엔티티 리스트 -->
        <list  name = "entity"> 
            <int   name = "targetID"/>
            <int   name = "targetEntityType"/>
            <float name = "posX"/>
            <float name = "posY"/>
            <float name = "posZ"/>
            <float name = "rotationY"/>
            <float name = "ab_sizeX"/>
            <float name = "ab_sizeY"/>
            <float name = "ab_sizeZ"/>
            <int   name = "damage"/>
        </list>
    </packet>

<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
</PDL>